{
  "handler": "Microsoft.Compute.VmExtension",
  "version": "0.0.1-preview",
  "parameters": {
    "elements": [
      {
        "name": "VSTSAccountUrl",
        "type": "Microsoft.Common.TextBox",
        "label": "Team Services Account URL",
        "toolTip": "The Team Services account to use.",
        "constraints": {
          "required": true,
          "regex": "^(https:\\/\\/).+\\.(visualstudio\\.com|vsallin\\.net)$",
          "validationMessage": "Account url must start with https:// and end with visualstudio.com."
        }
      },
      {
        "name": "TeamProject",
        "type": "Microsoft.Common.TextBox",
        "label": "Team Project",
        "toolTip": "Project in Team Services account to use.",
        "constraints": {
          "required": true
        }
      },
      {
        "name": "MachineGroup",
        "type": "Microsoft.Common.TextBox",
        "label": "Machine Group",
        "toolTip": "Machine group against which the agent will be configured.",
        "constraints": {
          "required": true
        }
      },
      {
        "name": "AgentName",
        "type": "Microsoft.Common.TextBox",
        "label": "Agent name",
        "toolTip": "Agent will run with this name.",
        "constraints": {
          "required": false
        }
      },
      {
        "name": "PATToken",
        "type": "Microsoft.Common.PasswordBox",
        "label": {
          "password": "PAT Token"
        },
        "toolTip": "PAT token will be used by extension to download and configure agent against Team Services account.",
        "constraints": {
          "required": true
        },
        "options": {
            "hideConfirmation": true
        }
      }
    ],
    "outputs": {
      "vmName": "[vmName()]",
      "location": "[location()]",
      "VSTSAccountUrl": "[elements('VSTSAccountUrl')]",
      "TeamProject": "[elements('TeamProject')]",
      "MachineGroup": "[elements('MachineGroup')]",
      "AgentName": "[elements('AgentName')]",
      "PATToken": "[elements('PATToken')]"
    }
  }
}